i:0:$0
f:{(i;x):x
 $["noop"~4#y;(i+1;x)
   "addx"~4#y;(i+2;x+`I$*1_" "\y)
   (i;x)]}
l:(1;1) f\i
fi:{i:&x=*'l;$[0=x;0;0=#i;fi[x-1];*l[i;1]]}
c:20 60 100 140 180 220
v:fi'c
+/c*v

p:{i:fi[x+1];d:40!x;$[|/i=(d-1;d;d+1);"#";"."]}'!40*6
6 40#p
