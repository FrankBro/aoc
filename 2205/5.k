i:0:$5
d:-1+
s:*&0=#'i
cs:((" "=)_)'{{x[1+y*4]}'[(s-1)#i;x]}'!-3!#*i
is:{os:(&" "=x)_x;.,/os@0 2 4}'1_s_i

f:{
 (q;a;b):(::;d;d)@'*y
 t:z@q#x@a
 x[a]:q_x@a
 x[b]:t,x@b
 $[0=#1_y;x;f[x;1_y;z]]}

s:{*'f[cs;is;x]}
s@{|x}
s@{x}
